
## <div align=center> **德雅自动化测试框架文档**</div>

----------
#### <div align=center>![enter image description here](http://images.gitbook.cn/2afa02d0-fa8d-11e7-98ba-49de68b07d22)</div>


----------

#### **德雅框架介绍**

> 德雅医疗是一家专业从事3D打印定制化牙科产品的创新型科技公司，致力于提供全方位数字化口腔问题解决方案。在项目的初期，德雅没有一个测试框架，在测试中，我们只有去点点点，目的是为了让功能不出现严重的bug。在项目进行迭代开发之后，传统的点点已经不适合迭代开发的模式了，为了帮助德雅项目快速推进，尽早得到项目质量的标准，特此开发此测试框架。
> 框架基础是由Python语言开发的，借助Selenium、HTMLTestRunner等python库进行底层结构架构设计。持续集成测试则使用Jenkins作为持续集成工具。

#### **搭建环境：**

> 系统：Window10
> 开发语言：Python3.6.2(更高版本都可以兼容)
> 开发工具：Pycharm
> 开发底层库：Selenium2

#### **框架结构**
#####  **框架开发模式**
德雅自动化测试框架使用的结构是使用目前流行的POM（Page Object Model）模式进行开发。

>  1. 页面对象模型(POM)是一种设计模式，用来管理维护一组web元素集的对象库
>  2. 在POM下，应用程序的每一个页面都有一个对应的page class
>  3. 每一个page class维护着该web页的元素集和操作这些元素的方法
>  4. page class中的方法命名最好根据其对应的业务场景进行，例如通常登录后我们需要等待几秒中，我们可以这样命名该方法:waitingForLoginSuccess().

下图为非POM和POM对比图：
#### <div align=center> ![enter image description here](http://images.gitbook.cn/218f5b80-fa8f-11e7-98ba-49de68b07d22)
##### **POM框架的优点：**

>  - POM提供了一种在UI层操作、业务流程与验证分离的模式，这使得测试代码变得更加清晰和高可读性
>  - 对象库与用例分离，使得我们更好的复用对象，甚至能与不同的工具进行深度结合应用
>  - 可复用的页面方法代码会变得更加优化
>  - 更加有效的命名方式使得我们更加清晰的知道方法所操作的UI元素。

#####  **框架结构**
![enter image description here](http://images.gitbook.cn/034be6b0-fa90-11e7-98ba-49de68b07d22)

> 目前框架的成熟度还在继续优化中，希望你能给框架带来更好的优化程度。 上面的所有名字均由本人自定义命名，现在介绍每个文件的作用：

#####  **API文件夹：**

    def delephone(phone):
        """
        这里是接口返回手机号码删除
        :param phone:输入手机号码
        :return:删除该手机号码
        """
        postdata = {'phone':phone}
        headers = {'content-type': 'application/json'}
    r=requests.post('http://112.74.29.84:23301/api/User/deleteuser',data=json.dumps(postdata),headers=headers)
        token_str = r.text
        token_dict = json.loads(token_str)
        if token_dict['success'] == True:
            return True
        else:
            return False

> 这个删除测试手机号的方法文件，在我们每次跑自动化测试的时候，我们经常地把手机号写死，为了方便后面每次的迭代，我向后台开发的同事要了这个删除手机号的接口，这个接口仅用于测试版本，在正式版本中是无法使用的。
> 使用的方式：
> Python+requests中的post方法做接口测试方法。具体方法可以到requests官网查看：
> http://cn.python-requests.org/zh_CN/latest/user/quickstart.html

#####  **Autolt文件夹：**

> 这个文件夹中包含的是我们在上传文件的时候使用到的工具，Autolt是python中经常用到的第三方工具，这个工具也方便了我们对上传下载文件的存放。关于Autolt教程，下面简单说一下：
> Autolt教程

#####  **BasePage文件夹：**

> 该文件夹的作用是对Selenium进行二次开发，使得Selenium适应我们当前的框架使用，也让我们在后面更好的使用selenium的方法。目前对selenium进行二次开发的了大部分的方法。但不是所有的方法都用得上，至少在我们需要用的时候，我们可以直接用上。强烈建议读这部分的代码，部分代码如下。

#####  **Common文件夹**

 
> 这个文件夹是用来处理异常类的，后来改成获取验证码的接口了，在获取验证码中，在前期我们经常碰到一个问题就是获取不到验证码，或者手机号获取验证码次数过多的情况，现在就将如果获取不到验证码就直接返回异常
> 使用的方法是Python+requests的get方法获取验证码的，和前面删除手机号的方法不一样，但是用的库是一样的。
#####  **image文件夹**
> 该文件夹是用来二次验证使用的，主要是为了防止我们在进行自动化测试的时候，返回的结果我们无法得到验证的情况，我们通过截图的结果得到进一步的验证，这样也保证了我们测试校验。

#####  **Lib文件夹**
> 建这个文件夹的目的是为了存放第三方的库，这样方便我们的脚本和系统分开，无论把我们的脚本放到哪都可以直接运行，只要当前电脑安装了Python3版本就可以直接运行我们的框架了。直到现在，我还没放进去。如果你准备熟悉这个框架之后，想继续扩展的话，建议把第三方库放在这里使用。

#####  **Pages文件夹**
 

> 这个文件夹使用存放页面元素的方法的，也就是POM中pages，我们将页面中所有元素都放在当前文件夹，等测试用例来调用，方便了我们的维护以及更新。在敏捷开发中，提醒一点就是每天的开发速度都会很快，一个测试人员的工作量如果不安排好很容易出错，出错导致的后果是我们今天的工作量没有得到完成。
> 所有，我们将每一个测试页面的元素都放在这里，在后面开发中，新的页面就新建新的方法类就可以了
> 目前里面包含的页面有：登录，注册，找回密码，个人中心 其中的方法：

#####  **report文件夹：**

> 这个文件夹不需要修改，因为这只是一个测试报告的文件夹  
> 简单说一下这个文件夹，一个css文件，一个js文件，一个HTMLtestrunner文件，其中css和js文件都是提供给HTMLtestrunner文件使用的，当前HTMLtestrunner命名和Python中的HTMLtestrunner命名是一样的，所以，是不能用来使用的，如果要调用的话，重命名就可以了。
> 生成的测试报告是result.html这个文件，右键点击run就可以看到我们每次迭代的结果了。包括错误都会详细的记录在报告中的，所以也不需要担心太多不知道哪里出错的问题了

#####  **TestCase文件夹：**
> 我们把每次要运行的步骤都写在这里，其中我们测试用例和page元素页命名尽量要一样，而且为了测试集的调用，我们每个文件的开头都一定要一样，否则在测试集中是无法被测试集执行
> 书写的方法就跟我们基础的方法是一样的。

#####  **UseData文件夹：**

> 这个文件夹的作用是存储数据，将我们要使用到的数据都放在这里，这样可以提高可用性和可重复性的使用。其中，这里的方法是使用了Python+openpyxl的库来写的，当我们在校验的时候要使用到很多重复的数据，我们就可以直接在这里调用了。这里可以学习怎样去使用openpyxl：
> http://openpyxl.readthedocs.io/en/default/
> 当我们使用测试集对全部测试用例执行的时候，我们需要把excel文件放在最外层

#####  **index.py文件：**

> 这个就是将所有测试用例集合在在一起的测试集，运行这个文件就可以将所有的测试用例执行了




